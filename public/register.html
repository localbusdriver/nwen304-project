<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Nwen304 Register</title>
    <link rel="stylesheet" href="register.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/ionicons@5.5.2/dist/css/ionicons.min.css">
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-database.js"></script>
  </head>
  <body>
    <div class="card">
        <form action="/register" method="post">
            <div class="content">
                
                <!-- <h2>Á•û</h2>  for the additional design -->
                <h3 class="register-title">Register</h3>
                <input style="width: 100%; padding: 10px; margin: 10px 0;" type="text" name="email" placeholder="Email" required />
                <input style="width: 100%; padding: 10px; margin: 10px 0;" type="text" name="username" placeholder="Username" required />
                <div class="password-wrapper">
                    <input style="width: 100%; padding: 10px; margin: 10px 0;" type="password" name="password" id="password" placeholder="passwords" required />
                    <span class="eye-icon" onclick="togglePasswordVisibility('password')" id="eyeIcon1">üôà</span>
                </div>
                <div class="password-wrapper">
                    <input style="width: 100%; padding: 10px; margin: 10px 0;" type="password" name="confirmPassword" id="confirmPassword" placeholder=" Confirm passwords" required />
                    <span class="eye-icon" onclick="togglePasswordVisibility('confirmPassword')" id="eyeIcon2">üôà</span>
                </div>
                <div id="passwordFeedback" style="color: red;"></div>
                <button style="width: 100%; padding: 10px; margin: 10px 0;" type="submit">Register</button>
            </div>
        </form>
    </div>

    <script type="text/javascript" src="register.js"></script>
    <script>
      VanillaTilt.init(document.querySelectorAll(".card"), {
        max: 5,
        speed: 400,
        glare: true,
        "max-glare": 1,
      });
    </script>
    <script>
        function togglePasswordVisibility(inputId) {
        const passwordInput = document.getElementById(inputId);
        const eyeIcon = document.getElementById(inputId === "password" ? "eyeIcon1" : "eyeIcon2");
        if (passwordInput.type === "password") {
            passwordInput.type = "text";
            eyeIcon.textContent = "üëÅÔ∏è"; 
        } else {
            passwordInput.type = "password";
            eyeIcon.textContent = "üôà"; 
        }
    }
    function validateForm() {
        const password = document.getElementById("password").value;
        const confirmPassword = document.getElementById("confirmPassword").value;
        const feedback = document.getElementById("passwordFeedback");
    
        if (password !== confirmPassword) {
            feedback.textContent = "Passwords do not match, please try again.";
            return false;
        }
    
        const regex = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[A-Za-z\d]{8,}$/;
        if (!regex.test(password)) {
            feedback.textContent = "Password should have at least 8 characters, one uppercase, one lowercase, and one number.";
            return false;
        }
    
        feedback.textContent = ""; // Clear feedback if no errors
        return true;
    }
    </script>
    <script>
        document.querySelector("form").addEventListener("submit", async function(event) {
            event.preventDefault();
    
            const formData = new FormData(this);
            const response = await fetch("/register", {
                method: "POST",
                body: formData
            });
    
            const feedback = document.getElementById("passwordFeedback");
            if (response.status === 400) {
                const errorMessage = await response.text();
                feedback.textContent = errorMessage;
            } else {
                window.location.href = "/login.html";  // Redirect to login page or any other page after successful registration
            }
        });
    </script>
  </body>
</html>
